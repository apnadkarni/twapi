#
# Copyright (c) 2010, Ashok P. Nadkarni
# All rights reserved.
#
# See the file LICENSE for license

# This file contains tests for power related commands.

package require tcltest
eval tcltest::configure $argv

source [file join [file dirname [info script]] testutil.tcl]
load_twapi_package

#
# Set up system-specific constants that are used to match test results
namespace eval twapi::power::test {
    namespace import ::tcltest::test

    ################################################################

    test get_power_status-1.0 {
        Get power status
    } -body {
        array set ps [twapi::get_power_status]
        expr {
              [oneof {on off unknown} $ps(-acstatus)] &&
              [oneof {critical low high unknown notpresent} $ps(-batterystate)] &&
              [oneof {true false unknown} $ps(-batterycharging)] &&
              ($ps(-batterylifepercent) eq "unknown" || [string is integer -strict $ps(-batterylifepercent)]) &&
              ($ps(-batterylifetime) eq "unknown" || [string is integer -strict $ps(-batterylifetime)]) &&
              ($ps(-batteryfulllifetime) eq "unknown" || [string is integer -strict $ps(-batteryfulllifetime)])
          }
    } -result 1

    ################################################################

    #
    # Clean up
    ::tcltest::cleanupTests
}

namespace delete ::twapi::power::test
